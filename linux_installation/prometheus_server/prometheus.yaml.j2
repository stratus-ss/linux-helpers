global:
    evaluation_interval: 15s
    scrape_interval: 15s
scrape_configs:
-   job_name: prometheus
    static_configs:
    -   targets:
        - localhost:9090

-   job_name: nodes
    static_configs:
    -   targets:
        {% if prometheus_node_targets is defined %}
        {% for target in prometheus_node_targets %}
        - {{ target }}
        {% endfor %}
        {% else %}
        {% for host in groups['all'] %}
        - {{ host }}:9100
        {% endfor %}
        {% endif %}